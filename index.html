<!DOCTYPE html>
<html lang="en-us">
  	<head>
		<meta charset="UTF-8">
		<title>con moto</title>
    		<meta name="viewport" content="width=device-width, initial-scale=1">
    		<link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    		<link href='https://fonts.googleapis.com/css?family=Varela+Round' rel='stylesheet' type='text/css'>
	</head>   
	<body>
		<h1>c o n  m o t o</h1>
     		<div id="sidebar"></div>
      		<div id="panels">
			<div id="playlist">
				<input title = "search" size=20 id="artist" name="artist"/>
				<button value="find" id="find" name="find">Find</button>
				<div id="results"> </div>
			</div>
     		 	<div id="interact">
        			<canvas id="canvas" width="928" height="550"></canvas>
      			</div>
      
    		</div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>  
    <script>
      $('#sidebar').mouseover(function(){
          $('#playlist').animate({width: '31%'}, 500);
          $('#interact').animate({width: '66%'}, 500);
        });
      $('#playlist').mouseleave(function(){
          $('#playlist').animate({width: '0%'}, 500);
          $('#interact').animate({width: '97%'}, 500);
        });
      </script>
    <script src="scripts/jquery-1.12.0.min.js"></script>
    <script src="scripts/audio.js"></script>
  </body>
  <script type="text/javacript">
  jQuery.ajaxSettings.traditional. = true;
  var config = getConfig();

  function getArtist(input){
	var url=config.echoNestHost + '/api/v4/playlist/static';
	$("#results").empty();
	$.getJSON(url, {'artist'=input,
			'api_key': config.apiKey,
			'bucket': 'audio_summary', 'limit'=true, 'variety'=1, 'results'=10, })
		.done(function(data){
			var title = "Results for" + artist;
			var spotifyPlayButton = playListButton(title, data.response.songs);
			$("#results").append(spotifyPlayButton);
		}
  }
  function getConfig(){
	return {
		apiKey: "KQOXQN3XYFH2F1T96"
		echoNestHost: "http://developer.echonest.com/"
	};
  }
  function playListButton(title, playlist){
	var link = '<iframe src="https://embed.spotify.com/?uri=spotify:trackset:TITLE:TRACKS" style="width:350px; height:250px;" frameborder="0"></iframe>';
	var ids = [];
	playlist.forEach(function(song) {
		var split = song.split(':');
		ids.push(split[split.length-1]);
	});
	var tracks = ids.join(',');
	var embed = link.replace('TRACKS',tracks);
	embed = embed.replace('TITLE',title);
	var li = $("<span>").html(embed);
	return $("<span>").html(embed);
}
function newSearch(){
	var artist = $("#artist").val();
	getArtist(artist);
}

function find(){
	$("#find").on("click", function() {
		newSearch();
	});
}

$(document).ready(function() {
	find();
});
  </script>
</html>


